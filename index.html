
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apotek Digital - Sistem Penjualan Obat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        .bounce-in {
            animation: bounceIn 0.6s ease-out;
        }
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        .cart-badge {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-green-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="bg-green-500 p-2 rounded-full">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">Apotek Digital</h1>
                        <p class="text-sm text-gray-600">Kesehatan Anda, Prioritas Kami</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showCart()" class="relative bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        <svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"/>
                        </svg>
                        Keranjang
                        <span id="cartBadge" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center cart-badge">0</span>
                    </button>
                    <button onclick="showAdminLogin()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors">
                        Admin
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Search Bar -->
        <div class="mb-8">
            <div class="max-w-4xl mx-auto">
                <div class="flex flex-col md:flex-row gap-4 items-center">
                    <div class="flex-1 relative">
                        <input type="text" id="searchInput" placeholder="Cari obat..." class="w-full px-4 py-3 pl-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <svg class="absolute left-4 top-3.5 w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterByCategory('all')" id="filter-all" class="px-4 py-2 rounded-lg bg-blue-500 text-white font-semibold transition-colors">
                            Semua
                        </button>
                        <button onclick="filterByCategory('discount')" id="filter-discount" class="px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600 font-semibold transition-colors">
                            üè∑Ô∏è Diskon
                        </button>
                        <button onclick="filterByCategory('Obat Bebas')" id="filter-Obat Bebas" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 font-semibold transition-colors">
                            Obat Bebas
                        </button>
                        <button onclick="filterByCategory('Obat Keras')" id="filter-Obat Keras" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 font-semibold transition-colors">
                            Obat Keras
                        </button>
                        <button onclick="filterByCategory('Vitamin')" id="filter-Vitamin" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 font-semibold transition-colors">
                            Vitamin
                        </button>
                        <button onclick="filterByCategory('Suplemen')" id="filter-Suplemen" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 font-semibold transition-colors">
                            Suplemen
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Products Grid -->
        <div id="productsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Products will be loaded here -->
        </div>
    </main>

    <!-- Cart Modal -->
    <div id="cartModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full max-h-96 overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">Keranjang Belanja</h2>
                        <button onclick="hideCart()" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    </div>
                    <div id="cartItems" class="space-y-4 mb-6">
                        <!-- Cart items will be loaded here -->
                    </div>
                    <div class="border-t pt-4">
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-xl font-bold">Total: </span>
                            <span id="cartTotal" class="text-xl font-bold text-green-600">Rp 0</span>
                        </div>
                        <button onclick="checkout()" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-semibold transition-colors">
                            Checkout via WhatsApp
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-md w-full">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">Login Admin</h2>
                        <button onclick="hideAdminLogin()" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Kode Admin:</label>
                        <input type="password" id="adminCode" placeholder="Masukkan kode admin" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <button onclick="adminLogin()" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg font-semibold transition-colors">
                        Login
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="fixed inset-0 bg-white z-50 hidden overflow-y-auto">
        <div class="container mx-auto px-4 py-8">
            <div class="flex justify-between items-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800">Panel Admin</h1>
                <button onclick="exitAdmin()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors">
                    Keluar
                </button>
            </div>
            
            <!-- Category Management -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold mb-4">Kelola Kategori</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Add Category -->
                    <div>
                        <h3 class="text-lg font-semibold mb-3">Tambah Kategori Baru</h3>
                        <div class="flex space-x-2">
                            <input type="text" id="newCategoryName" placeholder="Nama kategori baru" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <button onclick="addCategory()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors">
                                Tambah
                            </button>
                        </div>
                    </div>
                    
                    <!-- Category List -->
                    <div>
                        <h3 class="text-lg font-semibold mb-3">Kategori yang Ada</h3>
                        <div id="categoryList" class="space-y-2">
                            <!-- Categories will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add Product Form -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold mb-4">Tambah Produk Baru</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Nama Obat:</label>
                        <input type="text" id="productName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Harga:</label>
                        <input type="number" id="productPrice" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Diskon (%):</label>
                        <input type="number" id="productDiscount" min="0" max="100" value="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Stok:</label>
                        <input type="number" id="productStock" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Kategori:</label>
                        <select id="productCategory" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="Obat Bebas">Obat Bebas</option>
                            <option value="Obat Keras">Obat Keras</option>
                            <option value="Vitamin">Vitamin</option>
                            <option value="Suplemen">Suplemen</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Rating (1-5):</label>
                        <input type="number" id="productRating" min="1" max="5" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">Jumlah Terjual:</label>
                        <input type="number" id="productSold" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Deskripsi:</label>
                        <textarea id="productDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"></textarea>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-gray-700 text-sm font-bold mb-2">URL Gambar:</label>
                        <input type="url" id="productImage" placeholder="https://drive.google.com/file/d/... atau https://example.com/image.jpg" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <p class="text-xs text-gray-500 mt-1">üí° Tip: Untuk Google Drive, pastikan file diset ke "Anyone with the link can view"</p>
                    </div>
                </div>
                <button onclick="addProduct()" class="mt-4 bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                    Tambah Produk
                </button>
            </div>

            <!-- Products Management -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4">Kelola Produk</h2>
                <div id="adminProductsList" class="space-y-4">
                    <!-- Admin products list will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div id="editProductModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full max-h-96 overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">Edit Produk</h2>
                        <button onclick="hideEditProduct()" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Nama Obat:</label>
                            <input type="text" id="editProductName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Harga:</label>
                            <input type="number" id="editProductPrice" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Diskon (%):</label>
                            <input type="number" id="editProductDiscount" min="0" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Stok:</label>
                            <input type="number" id="editProductStock" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Kategori:</label>
                            <select id="editProductCategory" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="Obat Bebas">Obat Bebas</option>
                                <option value="Obat Keras">Obat Keras</option>
                                <option value="Vitamin">Vitamin</option>
                                <option value="Suplemen">Suplemen</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Rating (1-5):</label>
                            <input type="number" id="editProductRating" min="1" max="5" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">Jumlah Terjual:</label>
                            <input type="number" id="editProductSold" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2">Deskripsi:</label>
                            <textarea id="editProductDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2">URL Gambar:</label>
                            <input type="url" id="editProductImage" placeholder="https://drive.google.com/file/d/... atau https://example.com/image.jpg" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <p class="text-xs text-gray-500 mt-1">üí° Tip: Untuk Google Drive, pastikan file diset ke "Anyone with the link can view"</p>
                        </div>
                    </div>
                    <div class="flex space-x-4 mt-6">
                        <button onclick="updateProduct()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg font-semibold transition-colors">
                            Update Produk
                        </button>
                        <button onclick="hideEditProduct()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-semibold transition-colors">
                            Batal
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let products = [
            {
                id: 1,
                name: "Diana Tanafasa",
                price: 150000,
                discount: 0,
                stock: 50,
                sold: 15,
                rating: 4.5,
                category: "Obat Bebas",
                description: "Obat penurun demam dan pereda nyeri yang aman untuk dewasa dan anak-anak",
                image: "enhanced.watermark.03368679.jpg"
            },
            {
                id: 2,
                name: "Vitamin C 1000mg",
                price: 25000,
                discount: 15,
                stock: 30,
                sold: 8,
                rating: 4.8,
                category: "Vitamin",
                description: "Suplemen vitamin C untuk meningkatkan daya tahan tubuh",
                image: "https://unsplash.com/photos/buildings-facade-with-many-windows-and-shadows-gEEklhDGRK8"
            },
            {
                id: 3,
                name: "Amoxicillin 500mg",
                price: 35000,
                discount: 0,
                stock: 25,
                sold: 12,
                rating: 4.2,
                category: "Obat Keras",
                description: "Antibiotik untuk mengobati infeksi bakteri",
                image: "https://images.unsplash.com/photo-1471864190281-a93a3070b6de?w=400&h=300&fit=crop"
            },
            {
                id: 4,
                name: "Multivitamin",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
                            },
            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },
                        {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },            {
                id: 5,
                name: "Multivitamin2",
                price: 45000,
                discount: 25,
                stock: 40,
                sold: 22,
                rating: 4.7,
                category: "Suplemen",
                description: "Suplemen lengkap untuk kesehatan harian",
                image: "https://images.unsplash.com/photo-1550572017-edd951aa8ca6?w=400&h=300&fit=crop"
            },
        ];

        let categories = ["Obat Bebas", "Obat Keras", "Vitamin", "Suplemen"];

        let cart = [];
        let currentEditId = null;
        let currentCategoryFilter = 'all';
        const adminCode = "21062021";

        // Helper function to calculate discounted price
        function getDiscountedPrice(price, discount) {
            return Math.round(price * (100 - discount) / 100);
        }

        // Helper function to convert Google Drive URL to direct image URL
        function convertGoogleDriveUrl(url) {
            if (!url) return url;
            
            // Check if it's a Google Drive URL
            const driveRegex = /drive\.google\.com\/file\/d\/([a-zA-Z0-9_-]+)/;
            const match = url.match(driveRegex);
            
            if (match) {
                const fileId = match[1];
                return `https://drive.google.com/uc?export=view&id=${fileId}`;
            }
            
            // Check if it's already a direct Google Drive URL
            if (url.includes('drive.google.com/uc?')) {
                return url;
            }
            
            return url;
        }

        // Helper function to generate star rating display
        function generateStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            let stars = '';
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>';
            }
            
            if (hasHalfStar) {
                stars += '<svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><defs><linearGradient id="half"><stop offset="50%" stop-color="currentColor"/><stop offset="50%" stop-color="transparent"/></linearGradient></defs><path fill="url(#half)" d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>';
            }
            
            const emptyStars = 5 - Math.ceil(rating);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<svg class="w-4 h-4 text-gray-300" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>';
            }
            
            return stars;
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            setupSearch();
        });

        // Load products to grid
        function loadProducts(searchTerm = '') {
            const grid = document.getElementById('productsGrid');
            let filteredProducts = products.filter(product => {
                const matchesSearch = product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                    product.category.toLowerCase().includes(searchTerm.toLowerCase());
                let matchesCategory;
                if (currentCategoryFilter === 'all') {
                    matchesCategory = true;
                } else if (currentCategoryFilter === 'discount') {
                    matchesCategory = product.discount > 0;
                } else {
                    matchesCategory = product.category === currentCategoryFilter;
                }
                return matchesSearch && matchesCategory;
            });

            grid.innerHTML = filteredProducts.map(product => `
                <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow fade-in">
                    <div class="relative">
                        <img src="${convertGoogleDriveUrl(product.image)}" alt="${product.name}" class="w-full h-64 object-cover" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yMDAgMTUwQzIwMCAxNjYuNTY5IDE4Ni41NjkgMTgwIDE3MCAxODBDMTUzLjQzMSAxODAgMTQwIDE2Ni41NjkgMTQwIDE1MEMxNDAgMTMzLjQzMSAxNTMuNDMxIDEyMCAxNzAgMTIwQzE4Ni41NjkgMTIwIDIwMCAxMzMuNDMxIDIwMCAxNTBaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMzAgMTgwSDI2MEwyNDUgMjEwSDIxNUwyMzAgMTgwWiIgZmlsbD0iIzlCOUI5QiIvPgo8L3N2Zz4K'; this.alt='Gambar tidak tersedia';">
                        <div class="absolute top-2 right-2">
                            <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs font-semibold">
                                ${product.category}
                            </span>
                        </div>
                        ${product.stock <= 5 ? '<div class="absolute top-2 left-2"><span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs font-semibold">Stok Terbatas</span></div>' : ''}
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-2">${product.name}</h3>
                        <p class="text-gray-600 text-sm mb-3">${product.description}</p>
                        <div class="flex items-center mb-2">
                            <div class="flex text-yellow-400 mr-2">
                                ${generateStars(product.rating)}
                            </div>
                            <span class="text-sm text-gray-600">(${product.rating})</span>
                        </div>
                        <div class="flex justify-between items-center mb-2">
                            <div class="flex flex-col">
                                ${product.discount > 0 ? `
                                    <div class="flex items-center space-x-2">
                                        <span class="text-lg text-gray-400 line-through">Rp ${product.price.toLocaleString()}</span>
                                        <span class="bg-red-500 text-white px-2 py-1 rounded text-xs font-bold">-${product.discount}%</span>
                                    </div>
                                    <span class="text-2xl font-bold text-green-600">Rp ${getDiscountedPrice(product.price, product.discount).toLocaleString()}</span>
                                ` : `
                                    <span class="text-2xl font-bold text-green-600">Rp ${product.price.toLocaleString()}</span>
                                `}
                            </div>
                            <span class="text-sm text-gray-500">Stok: ${product.stock}</span>
                        </div>
                        <div class="text-sm text-blue-600 mb-4">
                            <span>Terjual: ${product.sold}</span>
                        </div>
                        <button onclick="addToCart(${product.id})" 
                                ${product.stock === 0 ? 'disabled' : ''}
                                class="w-full ${product.stock === 0 ? 'bg-gray-400 cursor-not-allowed' : 'bg-blue-500 hover:bg-blue-600'} text-white py-2 rounded-lg font-semibold transition-colors">
                            ${product.stock === 0 ? 'Stok Habis' : 'Tambah ke Keranjang'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Setup search functionality
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', (e) => {
                loadProducts(e.target.value);
            });
        }

        // Filter by category
        function filterByCategory(category) {
            currentCategoryFilter = category;
            
            // Update button styles
            document.querySelectorAll('[id^="filter-"]').forEach(btn => {
                if (btn.id === 'filter-discount') {
                    btn.className = 'px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600 font-semibold transition-colors';
                } else {
                    btn.className = 'px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 font-semibold transition-colors';
                }
            });
            
            const activeBtn = document.getElementById(`filter-${category}`);
            if (activeBtn) {
                if (category === 'discount') {
                    activeBtn.className = 'px-4 py-2 rounded-lg bg-red-600 text-white font-semibold transition-colors';
                } else {
                    activeBtn.className = 'px-4 py-2 rounded-lg bg-blue-500 text-white font-semibold transition-colors';
                }
            }
            
            const searchTerm = document.getElementById('searchInput').value;
            loadProducts(searchTerm);
        }

        // Add to cart
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product || product.stock === 0) return;

            const finalPrice = getDiscountedPrice(product.price, product.discount);

            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity++;
                } else {
                    alert('Stok tidak mencukupi!');
                    return;
                }
            } else {
                cart.push({
                    id: productId,
                    name: product.name,
                    price: finalPrice,
                    originalPrice: product.price,
                    discount: product.discount,
                    quantity: 1,
                    image: convertGoogleDriveUrl(product.image)
                });
            }

            updateCartBadge();
            showNotification('Produk ditambahkan ke keranjang!');
        }

        // Update cart badge
        function updateCartBadge() {
            const badge = document.getElementById('cartBadge');
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            badge.textContent = totalItems;
        }

        // Show cart modal
        function showCart() {
            const modal = document.getElementById('cartModal');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');

            if (cart.length === 0) {
                cartItems.innerHTML = '<p class="text-gray-500 text-center py-8">Keranjang kosong</p>';
                cartTotal.textContent = 'Rp 0';
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="flex items-center space-x-4 p-4 border rounded-lg">
                        <img src="${convertGoogleDriveUrl(item.image)}" alt="${item.name}" class="w-16 h-16 object-cover rounded" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0zMiAzMkMzMiAzNS4zMTM3IDI5LjMxMzcgMzggMjYgMzhDMjIuNjg2MyAzOCAyMCAzNS4zMTM3IDIwIDMyQzIwIDI4LjY4NjMgMjIuNjg2MyAyNiAyNiAyNkMyOS4zMTM3IDI2IDMyIDI4LjY4NjMgMzIgMzJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0zOCAzOEg0NEwzOSA0Nkg0NEwzOCAzOFoiIGZpbGw9IiM5QjlCOUIiLz4KPC9zdmc+Cg=='; this.alt='Gambar tidak tersedia';">
                        <div class="flex-1">
                            <h4 class="font-semibold">${item.name}</h4>
                            <div class="flex flex-col">
                                ${item.discount > 0 ? `
                                    <div class="flex items-center space-x-2">
                                        <span class="text-sm text-gray-400 line-through">Rp ${item.originalPrice.toLocaleString()}</span>
                                        <span class="bg-red-500 text-white px-1 py-0.5 rounded text-xs">-${item.discount}%</span>
                                    </div>
                                ` : ''}
                                <span class="text-gray-600 font-semibold">Rp ${item.price.toLocaleString()}</span>
                            </div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="updateCartQuantity(${item.id}, -1)" class="bg-gray-200 hover:bg-gray-300 w-8 h-8 rounded-full flex items-center justify-center">-</button>
                            <span class="w-8 text-center">${item.quantity}</span>
                            <button onclick="updateCartQuantity(${item.id}, 1)" class="bg-gray-200 hover:bg-gray-300 w-8 h-8 rounded-full flex items-center justify-center">+</button>
                        </div>
                        <button onclick="removeFromCart(${item.id})" class="text-red-500 hover:text-red-700">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    </div>
                `).join('');

                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                cartTotal.textContent = `Rp ${total.toLocaleString()}`;
            }

            modal.classList.remove('hidden');
        }

        // Hide cart modal
        function hideCart() {
            document.getElementById('cartModal').classList.add('hidden');
        }

        // Update cart quantity
        function updateCartQuantity(productId, change) {
            const product = products.find(p => p.id === productId);
            const cartItem = cart.find(item => item.id === productId);
            
            if (!cartItem) return;

            const newQuantity = cartItem.quantity + change;
            
            if (newQuantity <= 0) {
                removeFromCart(productId);
            } else if (newQuantity <= product.stock) {
                cartItem.quantity = newQuantity;
                showCart(); // Refresh cart display
                updateCartBadge();
            } else {
                alert('Stok tidak mencukupi!');
            }
        }

        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            showCart(); // Refresh cart display
            updateCartBadge();
        }

        // Checkout
        function checkout() {
            if (cart.length === 0) {
                alert('Keranjang kosong!');
                return;
            }

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const orderDetails = cart.map(item => 
                `${item.name} x${item.quantity} = Rp ${(item.price * item.quantity).toLocaleString()}`
            ).join('\n');

            const message = `Halo, saya ingin memesan:\n\n${orderDetails}\n\nTotal: Rp ${total.toLocaleString()}\n\nTerima kasih!`;
            const whatsappUrl = `https://wa.me/6281227480613?text=${encodeURIComponent(message)}`;
            
            window.open(whatsappUrl, '_blank');
            
            // Clear cart after checkout
            cart = [];
            updateCartBadge();
            hideCart();
            showNotification('Pesanan dikirim ke WhatsApp!');
        }

        // Show admin login
        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('hidden');
        }

        // Hide admin login
        function hideAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('hidden');
            document.getElementById('adminCode').value = '';
        }

        // Admin login
        function adminLogin() {
            const code = document.getElementById('adminCode').value;
            if (code === adminCode) {
                hideAdminLogin();
                showAdminPanel();
            } else {
                alert('Kode admin salah!');
            }
        }

        // Show admin panel
        function showAdminPanel() {
            document.getElementById('adminPanel').classList.remove('hidden');
            loadAdminProducts();
            loadCategoryList();
        }

        // Exit admin
        function exitAdmin() {
            document.getElementById('adminPanel').classList.add('hidden');
            clearAddProductForm();
        }

        // Load admin products
        function loadAdminProducts() {
            const list = document.getElementById('adminProductsList');
            list.innerHTML = products.map(product => `
                <div class="border rounded-lg p-4 flex items-center space-x-4">
                    <img src="${convertGoogleDriveUrl(product.image)}" alt="${product.name}" class="w-20 h-20 object-cover rounded" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik00MCA0MEM0MCA0NC40MTgzIDM2LjQxODMgNDggMzIgNDhDMjcuNTgxNyA0OCAyNCA0NC40MTgzIDI0IDQwQzI0IDM1LjU4MTcgMjcuNTgxNyAzMiAzMiAzMkMzNi40MTgzIDMyIDQwIDM1LjU4MTcgNDAgNDBaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik00OCA0OEg1NkwzMiA1NkgzMkw0OCA0OFoiIGZpbGw9IiM5QjlCOUIiLz4KPC9zdmc+Cg=='; this.alt='Gambar tidak tersedia';">
                    <div class="flex-1">
                        <h4 class="font-bold text-lg">${product.name}</h4>
                        <p class="text-gray-600">${product.category}</p>
                        <div class="flex flex-col">
                            ${product.discount > 0 ? `
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm text-gray-400 line-through">Rp ${product.price.toLocaleString()}</span>
                                    <span class="bg-red-500 text-white px-2 py-1 rounded text-xs font-bold">-${product.discount}%</span>
                                </div>
                                <span class="text-green-600 font-semibold">Rp ${getDiscountedPrice(product.price, product.discount).toLocaleString()}</span>
                            ` : `
                                <span class="text-green-600 font-semibold">Rp ${product.price.toLocaleString()}</span>
                            `}
                        </div>
                        <div class="flex items-center text-yellow-400 text-sm mb-1">
                            ${generateStars(product.rating)}
                            <span class="text-gray-600 ml-1">(${product.rating})</span>
                        </div>
                        <p class="text-sm text-gray-500">Stok: ${product.stock} | Terjual: ${product.sold}</p>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editProduct(${product.id})" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors">
                            Edit
                        </button>
                        <button onclick="deleteProduct(${product.id})" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors">
                            Hapus
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Add product
        function addProduct() {
            const name = document.getElementById('productName').value;
            const price = parseInt(document.getElementById('productPrice').value);
            const discount = parseInt(document.getElementById('productDiscount').value) || 0;
            const stock = parseInt(document.getElementById('productStock').value);
            const category = document.getElementById('productCategory').value;
            const description = document.getElementById('productDescription').value;
            const image = document.getElementById('productImage').value;
            const rating = parseFloat(document.getElementById('productRating').value) || 4.0;
            const sold = parseInt(document.getElementById('productSold').value) || 0;

            if (!name || !price || !stock || !description || !image) {
                alert('Semua field harus diisi!');
                return;
            }

            if (rating < 1 || rating > 5) {
                alert('Rating harus antara 1-5!');
                return;
            }

            if (discount < 0 || discount > 100) {
                alert('Diskon harus antara 0-100%!');
                return;
            }

            const newProduct = {
                id: Date.now(),
                name,
                price,
                discount,
                stock,
                sold,
                rating,
                category,
                description,
                image
            };

            products.push(newProduct);
            loadProducts();
            loadAdminProducts();
            clearAddProductForm();
            showNotification('Produk berhasil ditambahkan!');
        }

        // Clear add product form
        function clearAddProductForm() {
            document.getElementById('productName').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('productDiscount').value = '0';
            document.getElementById('productStock').value = '';
            document.getElementById('productCategory').value = 'Obat Bebas';
            document.getElementById('productDescription').value = '';
            document.getElementById('productImage').value = '';
            document.getElementById('productRating').value = '';
            document.getElementById('productSold').value = '';
        }

        // Edit product
        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (!product) return;

            currentEditId = id;
            document.getElementById('editProductName').value = product.name;
            document.getElementById('editProductPrice').value = product.price;
            document.getElementById('editProductDiscount').value = product.discount || 0;
            document.getElementById('editProductStock').value = product.stock;
            document.getElementById('editProductCategory').value = product.category;
            document.getElementById('editProductDescription').value = product.description;
            document.getElementById('editProductImage').value = product.image;
            document.getElementById('editProductRating').value = product.rating;
            document.getElementById('editProductSold').value = product.sold;

            document.getElementById('editProductModal').classList.remove('hidden');
        }

        // Hide edit product modal
        function hideEditProduct() {
            document.getElementById('editProductModal').classList.add('hidden');
            currentEditId = null;
        }

        // Update product
        function updateProduct() {
            if (!currentEditId) return;

            const name = document.getElementById('editProductName').value;
            const price = parseInt(document.getElementById('editProductPrice').value);
            const discount = parseInt(document.getElementById('editProductDiscount').value) || 0;
            const stock = parseInt(document.getElementById('editProductStock').value);
            const category = document.getElementById('editProductCategory').value;
            const description = document.getElementById('editProductDescription').value;
            const image = document.getElementById('editProductImage').value;
            const rating = parseFloat(document.getElementById('editProductRating').value);
            const sold = parseInt(document.getElementById('editProductSold').value);

            if (!name || !price || !stock || !description || !image || !rating || sold === undefined) {
                alert('Semua field harus diisi!');
                return;
            }

            if (rating < 1 || rating > 5) {
                alert('Rating harus antara 1-5!');
                return;
            }

            if (discount < 0 || discount > 100) {
                alert('Diskon harus antara 0-100%!');
                return;
            }

            const productIndex = products.findIndex(p => p.id === currentEditId);
            if (productIndex !== -1) {
                const oldSold = products[productIndex].sold;
                const soldDifference = sold - oldSold;
                
                // Adjust stock based on sold difference
                const newStock = stock + oldSold - sold;
                
                if (newStock < 0) {
                    alert('Stok tidak mencukupi untuk jumlah yang terjual!');
                    return;
                }

                products[productIndex] = {
                    ...products[productIndex],
                    name,
                    price,
                    discount,
                    stock: newStock,
                    sold,
                    rating,
                    category,
                    description,
                    image
                };

                loadProducts();
                loadAdminProducts();
                hideEditProduct();
                showNotification('Produk berhasil diupdate!');
            }
        }

        // Delete product
        function deleteProduct(id) {
            if (confirm('Apakah Anda yakin ingin menghapus produk ini?')) {
                products = products.filter(p => p.id !== id);
                cart = cart.filter(item => item.id !== id);
                loadProducts();
                loadAdminProducts();
                updateCartBadge();
                showNotification('Produk berhasil dihapus!');
            }
        }

        // Load category list
        function loadCategoryList() {
            const list = document.getElementById('categoryList');
            list.innerHTML = categories.map(category => `
                <div class="flex items-center justify-between p-3 border rounded-lg">
                    <span class="font-medium">${category}</span>
                    <div class="flex space-x-2">
                        <button onclick="editCategory('${category}')" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition-colors">
                            Edit
                        </button>
                        <button onclick="deleteCategory('${category}')" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-colors">
                            Hapus
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Add category
        function addCategory() {
            const newCategoryName = document.getElementById('newCategoryName').value.trim();
            
            if (!newCategoryName) {
                alert('Nama kategori tidak boleh kosong!');
                return;
            }

            if (categories.includes(newCategoryName)) {
                alert('Kategori sudah ada!');
                return;
            }

            categories.push(newCategoryName);
            updateCategorySelects();
            loadCategoryList();
            updateCategoryFilters();
            document.getElementById('newCategoryName').value = '';
            showNotification('Kategori berhasil ditambahkan!');
        }

        // Edit category
        function editCategory(oldCategory) {
            const newName = prompt('Masukkan nama kategori baru:', oldCategory);
            
            if (!newName || newName.trim() === '') {
                return;
            }

            const trimmedName = newName.trim();
            
            if (trimmedName === oldCategory) {
                return;
            }

            if (categories.includes(trimmedName)) {
                alert('Kategori sudah ada!');
                return;
            }

            // Update category in categories array
            const categoryIndex = categories.indexOf(oldCategory);
            if (categoryIndex !== -1) {
                categories[categoryIndex] = trimmedName;
            }

            // Update products that use this category
            products.forEach(product => {
                if (product.category === oldCategory) {
                    product.category = trimmedName;
                }
            });

            updateCategorySelects();
            loadCategoryList();
            loadAdminProducts();
            updateCategoryFilters();
            loadProducts();
            showNotification('Kategori berhasil diubah!');
        }

        // Delete category
        function deleteCategory(category) {
            const productsWithCategory = products.filter(p => p.category === category);
            
            if (productsWithCategory.length > 0) {
                alert(`Tidak dapat menghapus kategori "${category}" karena masih ada ${productsWithCategory.length} produk yang menggunakan kategori ini!`);
                return;
            }

            if (confirm(`Apakah Anda yakin ingin menghapus kategori "${category}"?`)) {
                categories = categories.filter(cat => cat !== category);
                updateCategorySelects();
                loadCategoryList();
                updateCategoryFilters();
                showNotification('Kategori berhasil dihapus!');
            }
        }

        // Update category selects in forms
        function updateCategorySelects() {
            const selects = ['productCategory', 'editProductCategory'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = categories.map(category => 
                        `<option value="${category}">${category}</option>`
                    ).join('');
                    
                    // Restore previous value if it still exists
                    if (categories.includes(currentValue)) {
                        select.value = currentValue;
                    }
                }
            });
        }

        // Update category filters
        function updateCategoryFilters() {
            const filterContainer = document.querySelector('.flex.flex-wrap.gap-2');
            if (!filterContainer) return;

            // Keep the "Semua" and "Diskon" buttons and rebuild category buttons
            const allButton = filterContainer.querySelector('#filter-all');
            const discountButton = filterContainer.querySelector('#filter-discount');
            filterContainer.innerHTML = '';
            filterContainer.appendChild(allButton);
            filterContainer.appendChild(discountButton);

            categories.forEach(category => {
                const button = document.createElement('button');
                button.id = `filter-${category}`;
                button.onclick = () => filterByCategory(category);
                button.className = currentCategoryFilter === category 
                    ? 'px-4 py-2 rounded-lg bg-blue-500 text-white font-semibold transition-colors'
                    : 'px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 font-semibold transition-colors';
                button.textContent = category;
                filterContainer.appendChild(button);
            });
        }

        // Show notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 bounce-in';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96b3745d87dda2f5',t:'MTc1NDUzNDkwMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>

</html>`






